<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
	<title>Joomla! CodeEditor</title>

    <!-- CSS for BootStrap-->
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">

    <!-- Script for jquery -->
    <script type="application/javascript" src="tinymce_dev/js/tinymce/assets/jquery.js"></script>

</head>
<body>
<div style="display:inline;position:absolute;top:50px;left:20px;">
<button class="btn" id="toggle" style=""><i class="icon-pencil"></i> Toggle</button>
<button id="preview" class="btn"><i class="icon-eye-open"></i> Preview</button>
</div>
    <div>
<form id="tinyForm" method="post" style="position:absolute;top:100px;left:0px;width:100%">
    <textarea id="mce"></textarea>
</form>
<form id="mirrorForm"  style="position:absolute;top:167px;left:0px;width:100%">
    <textarea id="code"></textarea>
</form>
</div>

<div id="myModal" class="modal hide fade in" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-body">
      
    </div>
</div>

    <!-- Script for Botstrap -->
    <script type="application/javascript" src="bootstrap/js/bootstrap.js"></script>

    <!-- Script for tinymce -->
    <script type="application/javascript" src="tinymce_dev/js/tinymce/tinymce.min.js"></script>

    <script type="text/javascript">
    tinymce.init({
        selector: "#mce",
        plugins: [
             "advlist autolink link image lists charmap print preview hr anchor pagebreak spellchecker",
             "searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking",
             "save table contextmenu directionality emoticons youtube template paste textcolor"
       ],
       height : 400
     });
    </script>

    <!-- Script for CodeMirror -->
    <script src="codemirror/lib/codemirror.js"></script>
    <link rel="stylesheet" href="codemirror/lib/codemirror.css">
    <script src="codemirror/addon/hint/show-hint.js"></script>
    <link rel="stylesheet" href="codemirror/addon/hint/show-hint.css">
    <script src="codemirror/addon/edit/closetag.js"></script>
    <script src="codemirror/addon/hint/html-hint.js"></script>
    <script src="codemirror/mode/xml/xml.js"></script>
    <script src="codemirror/mode/javascript/javascript.js"></script>
    <script src="codemirror/mode/css/css.js"></script>
    <script src="codemirror/mode/htmlmixed/htmlmixed.js"></script>

    <!-- Self defined Script -->
    <script type="text/javascript">
    $(function(){

        //Settings for codemirro
        CodeMirror.commands.autocomplete = function(cm) {
            CodeMirror.showHint(cm, CodeMirror.htmlHint);
        }

        var cmEditor = CodeMirror.fromTextArea(document.getElementById("code"), {
            mode: 'text/html',
            autoCloseTags: true,
            extraKeys: {"Ctrl-Space": "autocomplete"}
        });

        //setting view size
        var current = "tinymce";
        {
            cmEditor.setSize('100%', 400+"px");
        }

        //z-index for switching
        $("#tinyForm").css({"z-index" : 100});
        $("#mirrorForm").css({"z-index" : 10});

        //Toggle function
        $("#toggle").click(function(){
            if(current == "tinymce"){
                $("#tinyForm").css({"z-index" : 10});
                $("#mirrorForm").css({"z-index" : 100});
                current = "codemirror";
                cmEditor.setValue(tinyMCE.activeEditor.getContent({format : "raw"}));
            }
            else{
                $("#tinyForm").css({"z-index" : 100});
                $("#mirrorForm").css({"z-index" : 10});
                current = "tinymce";
                tinyMCE.activeEditor.setContent(cmEditor.getValue());
            }
        });

        //Preview Functionality
        $("#preview").click(function() {
            $.ajax({
                   url : 'previewFile.php',
                   type : 'GET',
                   dataType : 'HTML',
                   async: false,                  
                   success : function(data) { 
                        $(".modal-body").html(data +tinyMCE.activeEditor.getContent({format : "raw"} ));
                        $('#myModal').modal();
                      }
            });//end of ajax
        });//end of #preview click
    });

    </script>
</body>
</html>